<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Manage Categories</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    .form-container { margin-top: 2em; padding: 1em; border: 1px solid #ccc; border-radius: 5px; }
    .btn { padding: 5px 10px; border-radius: 3px; border: none; cursor: pointer; color: white; }
    .btn-delete { background-color: #dc3545; }
    .btn-submit { background-color: #007bff; }
    .nav { margin-bottom: 2em; }
    .message { padding: 10px; margin-bottom: 15px; border-radius: 4px; }
    .error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
  </style>
</head>
<body>

<nav class="nav">
  <a href="/"> ‚Üê Back to Dashboard</a>
</nav>

<h1>Manage Categories</h1>

<!-- Display Error or Success Messages -->
<div th:if="${errorMessage}" class="message error" th:text="${errorMessage}"></div>
<div th:if="${successMessage}" class="message success" th:text="${successMessage}"></div>

<!-- Section to Add a New Category -->
<div class="form-container">
  <h2>Add New Category</h2>
  <form th:action="@{/categories/add}" th:object="${newCategory}" method="post">
    <input type="text" th:field="*{name}" placeholder="Enter new category name" required />
    <button type="submit" class="btn btn-submit">Add Category</button>
  </form>
</div>

<!-- Table of Existing Categories -->
<h2>Existing Categories</h2>
<table>
  <thead>
  <tr>
    <th>ID</th>
    <th>Name</th>
    <th>Action</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="category : ${categories}">
    <td th:text="${category.id}">1</td>
    <td th:text="${category.name}">Groceries</td>
    <td>
      <!-- Each delete button is its own form to securely send a POST request -->
      <form th:action="@{/categories/delete/{id}(id=${category.id})}" method="post">
        <button type="submit" class="btn btn-delete"
                th:onclick="return confirm('Are you sure you want to delete this category?');">Delete</button>
      </form>
    </td>
  </tr>
  </tbody>
</table>

</body>
</html>